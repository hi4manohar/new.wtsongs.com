!function(t){function e(e,a,r){r=n(a,r);var o=e.currentTarget;if("A"!==o.tagName.toUpperCase())throw"$.fn.pjax or $.pjax.click requires an anchor element";if(!(e.which>1||e.metaKey||location.protocol!==o.protocol||location.host!==o.host||o.hash&&o.href.replace(o.hash,"")===location.href.replace(location.hash,""))){var i={url:o.href,container:t(o).attr("data-pjax"),target:o,clickedElement:t(o),fragment:null};return t.pjax(t.extend({},i,r)),e.preventDefault(),!1}}function a(t){return t.replace(/\?_pjax=[^&]+&?/,"?").replace(/_pjax=[^&]+&?/,"").replace(/[\?&]$/,"")}function r(t){var e=document.createElement("a");return e.href=t,e}function n(e,a){return e&&a?a.container=e:a=t.isPlainObject(e)?e:{container:e},a.container&&(a.container=o(a.container)),a}function o(e){if(e=t(e),e.length){if(""!==e.selector&&e.context===document)return e;if(e.attr("id"))return t("#"+e.attr("id"));throw"cant get selector for pjax container!"}throw"no pjax container for "+e.selector}t.fn.pjax=function(t,a){return this.live("click.pjax",function(r){return e(r,t,a)})};var i=t.pjax=function(e){function n(e,a){var r=t.Event(e,{relatedTarget:c});return f.trigger(r,a),!r.isDefaultPrevented()}e=t.extend(!0,{},t.ajaxSettings,i.defaults,e),t.isFunction(e.url)&&(e.url=e.url());var c=e.target;!c&&e.clickedElement&&(c=e.clickedElement[0]);var p=e.url,u=r(p).hash,l=e.beforeSend,s=e.complete,d=e.success,h=e.error,f=e.context=o(e.container);e.data||(e.data={}),e.data._pjax=f.selector;var m;e.beforeSend=function(t,r){p=a(r.url),r.timeout>0&&(m=setTimeout(function(){n("pjax:timeout",[t,e])&&t.abort("timeout")},r.timeout),r.timeout=0),t.setRequestHeader("X-PJAX","true"),t.setRequestHeader("X-PJAX-Container",f.selector);var o;return l&&(o=l.apply(this,arguments),o===!1)?!1:n("pjax:beforeSend",[t,r])?(n("pjax:start",[t,e]),void n("start.pjax",[t,e])):!1},e.complete=function(t,a){m&&clearTimeout(m),s&&s.apply(this,arguments),n("pjax:complete",[t,a,e]),n("pjax:end",[t,e]),n("end.pjax",[t,e])},e.error=function(t,r,o){var i=t.getResponseHeader("X-PJAX-URL");i&&(p=a(i)),h&&h.apply(this,arguments);var c=n("pjax:error",[t,r,o,e]);"abort"!==r&&c&&(window.location=p)},e.success=function(r,o,c){var l=c.getResponseHeader("X-PJAX-URL");l&&(p=a(l));var s,h=document.title;if(e.fragment){var f=t("<html>").html(r),m=f.find(e.fragment);if(!m.length)return window.location=p;this.html(m.contents()),s=f.find("title").text()||m.attr("title")||m.data("title")}else{if(!t.trim(r)||/<html/i.test(r))return window.location=p;this.html(r),s=this.find("title").remove().text()}s&&(document.title=t.trim(s));var x={url:p,pjax:this.selector,fragment:e.fragment,timeout:e.timeout};e.replace?(i.active=!0,window.history.replaceState(x,document.title,p)):e.push&&(i.active||(window.history.replaceState(t.extend({},x,{url:null}),h),i.active=!0),window.history.pushState(x,document.title,p)),(e.replace||e.push)&&window._gaq&&_gaq.push(["_trackPageview"]),""!==u&&(window.location.href=u),d&&d.apply(this,arguments),n("pjax:success",[r,o,c,e])};var x=i.xhr;return x&&x.readyState<4&&(x.onreadystatechange=t.noop,x.abort()),i.options=e,i.xhr=t.ajax(e),t(document).trigger("pjax",[i.xhr,e]),i.xhr};i.defaults={timeout:650,push:!0,replace:!1,type:"GET",dataType:"html"},i.click=e;var c="state"in window.history,p=location.href;t(window).bind("popstate",function(e){var a=!c&&location.href==p;if(c=!0,!a){var r=e.state;if(r&&r.pjax){var n=r.pjax;t(n+"").length?t.pjax({url:r.url||location.href,fragment:r.fragment,container:n,push:!1,timeout:r.timeout}):window.location=location.href}}}),t.inArray("state",t.event.props)<0&&t.event.props.push("state"),t.support.pjax=window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/((iPod|iPhone|iPad).+\bOS\s+[1-4]|WebApps\/.+CFNetwork)/),t.support.pjax||(t.pjax=function(e){var a=t.isFunction(e.url)?e.url():e.url,r=e.type?e.type.toUpperCase():"GET",n=t("<form>",{method:"GET"===r?"GET":"POST",action:a,style:"display:none"});"GET"!==r&&"POST"!==r&&n.append(t("<input>",{type:"hidden",name:"_method",value:r.toLowerCase()}));var o=e.data;if("string"==typeof o)t.each(o.split("&"),function(e,a){var r=a.split("=");n.append(t("<input>",{type:"hidden",name:r[0],value:r[1]}))});else if("object"==typeof o)for(key in o)n.append(t("<input>",{type:"hidden",name:key,value:o[key]}));t(document.body).append(n),n.submit()},t.pjax.click=t.noop,t.fn.pjax=function(){return this})}(jQuery);